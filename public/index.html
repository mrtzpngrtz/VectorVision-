<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ImageVector - Desktop</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css?v=horizontal_ui">
</head>
<body>
    <div id="app">
        <div id="main">
            <div id="map-container"></div>
            
            <div id="fps-counter">FPS: --</div>
            <div id="zoom-info">100%</div>

            <!-- Loading Overlay (Canvas Only) -->
            <div id="loading-overlay" style="display: none;">
                <div class="loading-content">
                    <div class="loader"></div>
                    <div id="status" class="status-text">Ready</div>
                    <div id="status-description" class="status-description">Preparing to process images...</div>
                    <div id="status-progress">
                        <div class="progress-bar-container">
                            <div class="progress-bar" id="progress-bar"></div>
                            <div class="progress-text" id="progress-percentage">0%</div>
                        </div>
                        <div class="stats-compact">
                            <span id="stat-processed">0</span> / <span id="stat-total">0</span> 
                            <span style="margin-left: 12px; opacity: 0.5;"><span id="stat-speed">0/s</span></span>
                            <span style="margin-left: 12px; opacity: 0.5;">ETA: <span id="stat-eta">--</span></span>
                        </div>
                    </div>
                    <!-- Detected Tags Display -->
                    <div id="detected-tags" class="detected-tags"></div>
                </div>
            </div>

            <!-- Image Preview Overlay -->
            <div id="image-preview-overlay" class="image-preview-overlay">
                <img id="preview-img" style="display: none;">
                <span id="preview-placeholder" style="opacity: 0.3; font-size: 0.7rem; font-family: monospace;">Hover image</span>
            </div>
        </div>

        <!-- Bottom Horizontal UI -->
        <div id="bottom-ui" class="bottom-ui">
            <!-- Libraries Section -->
            <div class="bottom-section">
                <label class="section-label" onclick="toggleBottomSection('libraries-dropdown')">
                    LIBRARIES <span class="chevron">▲</span>
                </label>
                <div id="libraries-dropdown" class="bottom-dropdown" style="display: none;">
                    <div id="libraries-list"></div>
                    <button onclick="createNewLibrary()" class="primary-btn compact">+ New</button>
                </div>
            </div>

            <!-- Display Section -->
            <div class="bottom-section">
                <label class="section-label">DISPLAY</label>
                <div class="bottom-controls">
                    <div class="radio-group-horizontal">
                        <button onclick="setViewMode(false)" id="view-2d" class="radio-btn active">2D</button>
                        <button onclick="setViewMode(true)" id="view-3d" class="radio-btn">3D</button>
                    </div>
                </div>
            </div>

            <!-- Sorting Section -->
            <div class="bottom-section">
                <label class="section-label">SORT</label>
                <div class="bottom-controls">
                    <div class="radio-group-horizontal">
                        <button onclick="setSorting('grid')" id="sort-grid" class="radio-btn">Grid</button>
                        <button onclick="setSorting('semantic')" id="sort-semantic" class="radio-btn active">Semantic</button>
                        <button onclick="setSorting('color')" id="sort-color" class="radio-btn">Color</button>
                        <button onclick="setSorting('lightness')" id="sort-lightness" class="radio-btn">Light</button>
                    </div>
                </div>
            </div>

            <!-- Filter Section -->
            <div class="bottom-section bottom-section-expand">
                <label class="section-label" onclick="toggleBottomSection('tags-dropdown')">
                    FILTER <span class="chevron">▲</span>
                </label>
                <div class="bottom-controls">
                    <div class="input-group-horizontal">
                        <input type="text" id="search-input" placeholder="Search tags...">
                        <button onclick="searchImages()" class="icon-btn" title="Search">→</button>
                        <button onclick="clearAll()" class="icon-btn" title="Clear">✕</button>
                    </div>
                </div>
                <div id="tags-dropdown" class="bottom-dropdown tags-dropdown" style="display: none;">
                    <div id="library-wordcloud-section">
                        <div id="library-wordcloud" class="library-wordcloud-horizontal"></div>
                    </div>
                </div>
            </div>

            <!-- Info Section -->
            <div class="bottom-section">
                <label class="section-label">INFO</label>
                <div class="bottom-info">
                    <div id="semantic-info" class="info-compact">Hover image...</div>
                    <div id="system-specs" class="specs-compact">
                        <span id="hw-accel-status">READY</span>
                    </div>
                </div>
            </div>

            <!-- 3D Controls Section (shown conditionally) -->
            <div id="view-presets" class="bottom-section" style="display:none;">
                <label class="section-label">3D</label>
                <div class="bottom-controls">
                    <button id="auto-move-toggle" onclick="toggleAutoMove()" class="secondary-btn compact" style="padding: 6px 10px; font-size: 0.6rem;">DRIFT: ON</button>
                </div>
            </div>

            <!-- Toggle UI Button -->
            <div class="bottom-section">
                <button onclick="toggleUI()" class="icon-btn-large" title="Hide UI">▼</button>
            </div>
        </div>

        <!-- Restore UI Button (shown when hidden) -->
        <div class="ui-toggle-btn-bottom" onclick="toggleUI()" title="Show UI">
            ▲
        </div>
    </div>

    <!-- Lightbox -->
    <div id="lightbox">
        <img id="lightbox-img">
        <div class="lightbox-close" onclick="document.getElementById('lightbox').style.display='none'">&times;</div>
    </div>

    <!-- Library Name Modal -->
    <div id="library-modal" style="display: none;">
        <div class="modal-content">
            <h3>Library Name</h3>
            <input type="text" id="library-name-input" placeholder="Enter library name...">
            <div class="modal-buttons">
                <button onclick="confirmLibraryName()" class="primary-btn">Save</button>
                <button onclick="cancelLibraryName()" class="secondary-btn">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Custom Confirm Dialog -->
    <div id="confirm-modal" style="display: none;">
        <div class="modal-content confirm-modal">
            <h3 id="confirm-title">Confirm Action</h3>
            <p id="confirm-message"></p>
            <div class="modal-buttons">
                <button id="confirm-ok-btn" class="primary-btn">OK</button>
                <button id="confirm-cancel-btn" class="secondary-btn">Cancel</button>
            </div>
        </div>
    </div>

    <script src="js/app.js"></script>
</body>
</html>
